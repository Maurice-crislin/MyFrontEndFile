<html>
    <head>
        <title>绘制一个点</title>
        <script src="./glMatrix-0.9.6.min.js"></script>
        <script>
            var webgl,projMat4=mat4.create();
            var vertexString=`
            attribute vec4 a_position;
            uniform mat4 proj;
            void main(){
                gl_Position=proj*a_position;
                gl_PointSize=20.0;//点的大小
            }
            `;

            var fragmentString=`
            void main(){
                gl_FragColor=vec4(0,0,1.0,1.0);
            }
            `;
            //入口函数
            function init(){
                initWebgl();
                initShader();
                initBuffer();
                draw();
            }
            function initWebgl(){
                let webglDiv = document.getElementById('webglCanvas');
                webgl = webglDiv.getContext('webgl');
                webgl.viewport(0,0,webglDiv.clientWidth,webglDiv.clientHeight);
                mat4.ortho(0,webglDiv.clientWidth,webglDiv.clientHeight,0,-1,1,projMat4);
            }
            function initShader(){

                let vsshader=webgl.createShader(webgl.VERTEX_SHADER);
                let fsshader=webgl.createShader(webgl.FRAGMENT_SHADER);

                webgl.shaderSource(vsshader,vertexString);//容器 容器文本
                webgl.shaderSource(fsshader,fragmentString);

                webgl.compileShader(vsshader);
                webgl.compileShader(fsshader);

                let program=webgl.createProgram();
                webgl.attachShader(program,vsshader);
                webgl.attachShader(program,fsshader);

                webgl.linkProgram(program);
                webgl.useProgram(program);//这一句很重要，不然不会出现所绘制的矩形

                webgl.program=program;

            }
            function initBuffer(){
                let pointPosition = new Float32Array([40.0,100.0,0.0,1.0]);//点的位置
                let aPosition=webgl.getAttribLocation(webgl.program,'a_position');
                webgl.vertexAttrib4fv(aPosition,pointPosition);

                let uniformproj = webgl.getUniformLocation(webgl.program,'proj');
                webgl.uniformMatrix4fv(uniformproj,false,projMat4); 
            }
            //绘制函数
            function draw(){
                webgl.clearColor(0.0,0.0,0.0,1.0);
                webgl.clear(webgl.COLOR_BUFFER_BIT);
                webgl.drawArrays(webgl.POINTS,0,1);
            }
        </script>
    </head>
    <body onload="init()">
        <canvas id="webglCanvas" width="500" height="500"></canvas>
    </body>
</html>